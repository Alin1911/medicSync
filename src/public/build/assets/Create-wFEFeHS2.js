import{v as b,j as e,$ as v}from"./app-DqdAfCqj.js";import{A as f}from"./AuthenticatedLayout-ca36Maum.js";import"./transition-bDEZoVcr.js";function y({patients:c,medications:o}){const{data:i,setData:l,post:m,processing:u}=b({patient_id:"",issued_at:"",expires_at:"",details:"",medications:[]}),d=(a,s,n)=>{const t=[...i.medications],r=t.findIndex(h=>h.id===a);r===-1?t.push({id:a,[s]:n}):t[r]={...t[r],[s]:n},l("medications",t)},x=a=>{const s=[...i.medications];s.find(t=>t.id===a)?l("medications",s.filter(t=>t.id!==a)):l("medications",[...s,{id:a,frecventa:"",interval_ore:""}])},p=a=>{a.preventDefault();const s=i.medications.filter(n=>n.id&&n.frecventa&&n.interval_ore);if(s.length===0){alert("Adaugă cel puțin un medicament complet.");return}l("medications",s),m(route("prescriptions.store"))};return e.jsxs(f,{children:[e.jsx(v,{title:"Creează Rețetă"}),e.jsxs("form",{onSubmit:p,className:"mx-auto max-w-2xl rounded bg-white p-6 shadow",children:[e.jsx("h1",{className:"mb-4 text-xl font-bold",children:"Creează Rețetă"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Pacient"}),e.jsxs("select",{value:i.patient_id,onChange:a=>l("patient_id",a.target.value),className:"w-full rounded border px-3 py-2",children:[e.jsx("option",{value:"",children:"Selectează pacient"}),c.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{className:"mb-4 flex gap-4",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Data emiterii"}),e.jsx("input",{type:"date",value:i.issued_at,onChange:a=>l("issued_at",a.target.value),className:"w-full rounded border px-3 py-2"})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Data expirării"}),e.jsx("input",{type:"date",value:i.expires_at,onChange:a=>l("expires_at",a.target.value),className:"w-full rounded border px-3 py-2"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium",children:"Detalii"}),e.jsx("textarea",{value:i.details,onChange:a=>l("details",a.target.value),placeholder:"Detalii opționale",className:"w-full rounded border px-3 py-2"})]}),e.jsx("h2",{className:"mb-2 text-lg font-semibold",children:"Medicamente"}),e.jsx("div",{className:"space-y-3",children:o.map(a=>{const s=i.medications.some(t=>t.id===a.id),n=i.medications.find(t=>t.id===a.id)||{};return e.jsxs("div",{className:"rounded border p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 font-medium",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:()=>x(a.id)}),a.nume]}),s&&e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("input",{type:"number",placeholder:"Frecvență",value:n.frecventa||"",onChange:t=>d(a.id,"frecventa",t.target.value),className:"w-1/2 rounded border px-2 py-1"}),e.jsx("input",{type:"number",placeholder:"Interval ore",value:n.interval_ore||"",onChange:t=>d(a.id,"interval_ore",t.target.value),className:"w-1/2 rounded border px-2 py-1"})]})]},a.id)})}),e.jsx("button",{type:"submit",disabled:u,className:"mt-6 rounded bg-green-600 px-4 py-2 text-white hover:bg-green-700",children:"Salvează Rețeta"}),e.jsx("pre",{className:"mt-4 bg-gray-100 text-xs p-2 rounded",children:JSON.stringify(i.medications,null,2)})]})]})}export{y as default};
